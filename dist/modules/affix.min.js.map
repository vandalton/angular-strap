{"version":3,"sources":["modules/affix.js"],"names":["angular","bodyEl","document","body","defaults","windowEl","offsetTop","AffixFactory","inlineStyles","$affix","setWidth","options","this","$get","reset","$window","debounce","dimensions","initialOffsetTop","config","getRequiredAffixClass","_unpin","position","top","scrollTop","getScrollTop","scrollHeight","getScrollHeight","targetEl","pageYOffset","offsetBottom","elementHeight","initialAffixTop","directive","$timeout","extend","affixed","target","unpin","parent","element","offsetParent","i","match","init","$parseOffsets","on","checkPosition","require","checkPositionWithEventLoop","offset","destroy","style","width","off","affix","setTimeout","height","css","offsetUnpin","offsetHeight","removeClass","addClass","offsetWidth","$onResize","initialTop","$debouncedOnResize","initialPosition","restrict","affixTarget","$element","forEach","link","key","scope","option","attr","test","controller"],"mappings":"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","file":"affix.min.js","sourcesContent":["'use strict';\r\n\r\nangular.module('mgcrea.ngStrap.affix', ['mgcrea.ngStrap.helpers.dimensions', 'mgcrea.ngStrap.helpers.debounce'])\r\n\r\n  .provider('$affix', function () {\r\n\r\n    var defaults = this.defaults = {\r\n      offsetTop: 'auto',\r\n      inlineStyles: true,\r\n      setWidth: true\r\n    };\r\n\r\n    this.$get = function ($window, debounce, dimensions) {\r\n\r\n      var bodyEl = angular.element($window.document.body);\r\n      var windowEl = angular.element($window);\r\n\r\n      function AffixFactory (element, config) {\r\n\r\n        var $affix = {};\r\n\r\n        // Common vars\r\n        var options = angular.extend({}, defaults, config);\r\n        var targetEl = options.target;\r\n\r\n        // Initial private vars\r\n        var reset = 'affix affix-top affix-bottom';\r\n        var setWidth = false;\r\n        var initialAffixTop = 0;\r\n        var initialOffsetTop = 0;\r\n        var offsetTop = 0;\r\n        var offsetBottom = 0;\r\n        var affixed = null;\r\n        var unpin = null;\r\n\r\n        var parent = element.parent();\r\n        // Options: custom parent\r\n        if (options.offsetParent) {\r\n          if (options.offsetParent.match(/^\\d+$/)) {\r\n            for (var i = 0; i < (options.offsetParent * 1) - 1; i++) {\r\n              parent = parent.parent();\r\n            }\r\n          } else {\r\n            parent = angular.element(options.offsetParent);\r\n          }\r\n        }\r\n\r\n        $affix.init = function () {\r\n\r\n          this.$parseOffsets();\r\n          initialOffsetTop = dimensions.offset(element[0]).top + initialAffixTop;\r\n          setWidth = options.setWidth && !element[0].style.width;\r\n\r\n          // Bind events\r\n          targetEl.on('scroll', this.checkPosition);\r\n          targetEl.on('click', this.checkPositionWithEventLoop);\r\n          windowEl.on('resize', this.$debouncedOnResize);\r\n\r\n          // Both of these checkPosition() calls are necessary for the case where\r\n          // the user hits refresh after scrolling to the bottom of the page.\r\n          this.checkPosition();\r\n          this.checkPositionWithEventLoop();\r\n\r\n        };\r\n\r\n        $affix.destroy = function () {\r\n\r\n          // Unbind events\r\n          targetEl.off('scroll', this.checkPosition);\r\n          targetEl.off('click', this.checkPositionWithEventLoop);\r\n          windowEl.off('resize', this.$debouncedOnResize);\r\n\r\n        };\r\n\r\n        $affix.checkPositionWithEventLoop = function () {\r\n\r\n          // IE 9 throws an error if we use 'this' instead of '$affix'\r\n          // in this setTimeout call\r\n          setTimeout($affix.checkPosition, 1);\r\n\r\n        };\r\n\r\n        $affix.checkPosition = function () {\r\n          // if (!this.$element.is(':visible')) return\r\n\r\n          var scrollTop = getScrollTop();\r\n          var position = dimensions.offset(element[0]);\r\n          var elementHeight = dimensions.height(element[0]);\r\n\r\n          // Get required affix class according to position\r\n          var affix = getRequiredAffixClass(unpin, position, elementHeight);\r\n\r\n          // Did affix status changed this last check?\r\n          if (affixed === affix) return;\r\n          affixed = affix;\r\n\r\n          if (affix === 'top') {\r\n            unpin = null;\r\n            if (setWidth) {\r\n              element.css('width', '');\r\n            }\r\n            if (options.inlineStyles) {\r\n              element.css('position', (options.offsetParent) ? '' : 'relative');\r\n              element.css('top', '');\r\n            }\r\n          } else if (affix === 'bottom') {\r\n            if (options.offsetUnpin) {\r\n              unpin = -(options.offsetUnpin * 1);\r\n            } else {\r\n              // Calculate unpin threshold when affixed to bottom.\r\n              // Hopefully the browser scrolls pixel by pixel.\r\n              unpin = position.top - scrollTop;\r\n            }\r\n            if (setWidth) {\r\n              element.css('width', '');\r\n            }\r\n            if (options.inlineStyles) {\r\n              element.css('position', (options.offsetParent) ? '' : 'relative');\r\n              element.css('top', (options.offsetParent) ? '' : ((bodyEl[0].offsetHeight - offsetBottom - elementHeight - initialOffsetTop) + 'px'));\r\n            }\r\n          } else { // affix === 'middle'\r\n            unpin = null;\r\n            if (setWidth) {\r\n              element.css('width', element[0].offsetWidth + 'px');\r\n            }\r\n            if (options.inlineStyles) {\r\n              element.css('position', 'fixed');\r\n              element.css('top', initialAffixTop + 'px');\r\n            }\r\n          }\r\n\r\n          // Add proper affix class\r\n          element.removeClass(reset).addClass('affix' + ((affix !== 'middle') ? '-' + affix : ''));\r\n\r\n        };\r\n\r\n        $affix.$onResize = function () {\r\n          $affix.$parseOffsets();\r\n          $affix.checkPosition();\r\n        };\r\n        $affix.$debouncedOnResize = debounce($affix.$onResize, 50);\r\n\r\n        $affix.$parseOffsets = function () {\r\n          var initialPosition = element[0].style.position;\r\n          var initialTop = element[0].style.top;\r\n          // Reset position to calculate correct offsetTop\r\n          if (options.inlineStyles) {\r\n            element.css('position', (options.offsetParent) ? '' : 'relative');\r\n            element.css('top', '');\r\n          }\r\n\r\n          if (options.offsetTop) {\r\n            if (options.offsetTop === 'auto') {\r\n              options.offsetTop = '+0';\r\n            }\r\n            if (options.offsetTop.match(/^[-+]\\d+$/)) {\r\n              initialAffixTop = - options.offsetTop * 1;\r\n              if (options.offsetParent) {\r\n                offsetTop = dimensions.offset(parent[0]).top + (options.offsetTop * 1);\r\n              } else {\r\n                offsetTop = dimensions.offset(element[0]).top - dimensions.css(element[0], 'marginTop', true) + (options.offsetTop * 1);\r\n              }\r\n            } else {\r\n              offsetTop = options.offsetTop * 1;\r\n            }\r\n          }\r\n\r\n          if (options.offsetBottom) {\r\n            if (options.offsetParent && options.offsetBottom.match(/^[-+]\\d+$/)) {\r\n              // add 1 pixel due to rounding problems...\r\n              offsetBottom = getScrollHeight() - (dimensions.offset(parent[0]).top + dimensions.height(parent[0])) + (options.offsetBottom * 1) + 1;\r\n            } else {\r\n              offsetBottom = options.offsetBottom * 1;\r\n            }\r\n          }\r\n\r\n          // Bring back the element's position after calculations\r\n          if (options.inlineStyles) {\r\n            element.css('position', initialPosition);\r\n            element.css('top', initialTop);\r\n          }\r\n        };\r\n\r\n        // Private methods\r\n\r\n        function getRequiredAffixClass (_unpin, position, elementHeight) {\r\n          var scrollTop = getScrollTop();\r\n          var scrollHeight = getScrollHeight();\r\n\r\n          if (scrollTop <= offsetTop) {\r\n            return 'top';\r\n          } else if (_unpin !== null) {\r\n            return scrollTop + _unpin <= position.top ? 'middle' : 'bottom';\r\n          } else if (offsetBottom !== null && (position.top + elementHeight + initialAffixTop >= scrollHeight - offsetBottom)) {\r\n            return 'bottom';\r\n          }\r\n          return 'middle';\r\n        }\r\n\r\n        function getScrollTop () {\r\n          return targetEl[0] === $window ? $window.pageYOffset : targetEl[0].scrollTop;\r\n        }\r\n\r\n        function getScrollHeight () {\r\n          return targetEl[0] === $window ? $window.document.body.scrollHeight : targetEl[0].scrollHeight;\r\n        }\r\n\r\n        $affix.init();\r\n        return $affix;\r\n\r\n      }\r\n\r\n      return AffixFactory;\r\n\r\n    };\r\n\r\n  })\r\n\r\n  .directive('bsAffix', function ($affix, $window, $timeout) {\r\n\r\n    return {\r\n      restrict: 'EAC',\r\n      require: '^?bsAffixTarget',\r\n      link: function postLink (scope, element, attr, affixTarget) {\r\n\r\n        var options = {scope: scope, target: affixTarget ? affixTarget.$element : angular.element($window)};\r\n        angular.forEach(['offsetTop', 'offsetBottom', 'offsetParent', 'offsetUnpin', 'inlineStyles', 'setWidth'], function (key) {\r\n          if (angular.isDefined(attr[key])) {\r\n            var option = attr[key];\r\n            if (/true/i.test(option)) option = true;\r\n            if (/false/i.test(option)) option = false;\r\n            options[key] = option;\r\n          }\r\n        });\r\n\r\n        var affix;\r\n        $timeout(function () { affix = $affix(element, options); });\r\n        scope.$on('$destroy', function () {\r\n          if (affix) affix.destroy();\r\n          options = null;\r\n          affix = null;\r\n        });\r\n\r\n      }\r\n    };\r\n\r\n  })\r\n\r\n  .directive('bsAffixTarget', function () {\r\n    return {\r\n      controller: function ($element) {\r\n        this.$element = $element;\r\n      }\r\n    };\r\n  });\r\n"]}